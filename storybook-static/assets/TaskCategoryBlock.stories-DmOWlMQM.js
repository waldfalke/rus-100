import{j as s}from"./jsx-runtime-DoEZbXM1.js";import{r as u}from"./index-DWtqY3O_.js";import{C as $,c as _}from"./card-CovcHCaV.js";import{B as j}from"./button-DWZKWoqU.js";import{B as N}from"./badge-BhI_kZ9I.js";import{S as z}from"./separator-CMLfmBb-.js";import{T as F}from"./task-category-selector-CyPtx4Pg.js";import{C as M,a as O}from"./chevron-up-BDhz3SY9.js";import{D as R}from"./dice-3-DukkMB4k.js";import"./jsx-runtime-Bw5QeaCk.js";import"./utils-CytzSlOG.js";import"./index-BghTMhg4.js";import"./index-BwobEAja.js";import"./index-h8DnG9fi.js";import"./index-DZJH1aMv.js";import"./index-CWNAz4Fr.js";import"./popover-C4RQM193.js";import"./index-DHaFAply.js";import"./index-4JJ3X7d3.js";import"./index-C9Cbq-BE.js";import"./index-BnuSz0lM.js";import"./Combination-Dlu6W2yo.js";import"./index-k2os2MFt.js";import"./index-BAy4v6XH.js";import"./createLucideIcon-BySMWYsL.js";const h={category:"Работа с текстом",items:[{id:"1",title:"№1. Средства связи предложений в тексте",count:0,maxCount:5},{id:"2",title:"№2. Определение темы и главной мысли текста",count:2,maxCount:5}]},A={1:{easiest:2,easy:1,medium:1,hard:0,hardest:0},2:{easiest:0,easy:2,medium:2,hard:1,hardest:0}},I=[{id:"easiest",label:"Самые лёгкие"},{id:"easy",label:"Лёгкие"},{id:"medium",label:"Средние"},{id:"hard",label:"Сложные"},{id:"hardest",label:"Самые сложные"}],me={title:"Blocks/TaskCategoryBlock",render:()=>{const[g,w]=u.useState(!0),[l,k]=u.useState({}),[v,S]=u.useState({}),[D,B]=u.useState({1:0,2:2}),f=(e,t)=>{k(a=>{const i=a[e]||[];if(t==="any")return{...a,[e]:["any"]};let r;return i.includes(t)?(r=i.filter(o=>o!==t),r.length===0&&(r=["any"])):r=i.filter(o=>o!=="any").concat(t),{...a,[e]:r}})},T=(e,t)=>{S(a=>({...a,[e]:t}))},y=(e,t)=>{B(a=>{var d;const i=a[e]||0,r=((d=h.items.find(m=>m.id===e))==null?void 0:d.maxCount)||10,o=Math.max(0,Math.min(r,i+t));return{...a,[e]:o}})},E=e=>{var o,d,m,C;const t=D[e.id]||0,a=e.maxCount||10,i=A[e.id],r=(o=e.title.match(/№\s*(\d+)/))==null?void 0:o[1];return s.jsx($,{className:"border border-gray-200 mb-2",children:s.jsx(_,{className:"p-3 sm:p-4",children:s.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-grow pr-4",children:[s.jsx("span",{className:"text-sm text-gray-800",children:e.title}),r&&s.jsx(F,{taskNumber:r,selectedCategories:v[e.id]||[],onCategoriesChange:n=>T(e.id,n)})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 w-full sm:w-auto justify-end",children:[s.jsx("div",{className:"flex flex-wrap gap-1.5 items-center",children:i?s.jsxs(s.Fragment,{children:[s.jsxs(N,{variant:!l[e.id]||(d=l[e.id])!=null&&d.includes("any")?"default":"outline",onClick:()=>f(e.id,"any"),className:`cursor-pointer transition-colors text-sm px-2 py-0.5 flex items-center gap-1 ${!l[e.id]||(m=l[e.id])!=null&&m.includes("any")?"bg-teal-600 hover:bg-teal-700 text-white border-teal-600":"border-gray-300 text-gray-700 hover:bg-gray-100"}`,role:"radio","aria-checked":!l[e.id]||((C=l[e.id])==null?void 0:C.includes("any")),tabIndex:0,children:[s.jsx(R,{className:"w-3 h-3"}),"Любая (",s.jsxs("span",{className:"text-sm",children:[Object.values(i).reduce((n,x)=>n+x,0),")"]})]},`${e.id}-any`),I.map(n=>{var b;const x=i[n.id]||0,c=x===0,p=(b=l[e.id])==null?void 0:b.includes(n.id);return s.jsxs(N,{variant:p&&!c?"default":"outline",onClick:()=>!c&&f(e.id,n.id),className:`cursor-pointer transition-colors text-sm px-2 py-0.5 ${c?"cursor-not-allowed opacity-50 bg-gray-100 text-gray-400 border-gray-200":p?"bg-teal-600 hover:bg-teal-700 text-white border-teal-600":"border-gray-300 text-gray-700 hover:bg-gray-100"}`,"aria-disabled":c,role:"radio","aria-checked":p&&!c,tabIndex:c?-1:0,children:[n.label," (",s.jsxs("span",{className:"text-sm",children:[x,")"]})]},`${e.id}-${n.id}`)})]}):s.jsx("span",{className:"text-xs text-gray-400 italic",children:"Нет данных о сложности"})}),s.jsx(z,{orientation:"vertical",className:"h-6 hidden sm:block"}),s.jsxs("div",{className:"flex items-center space-x-1.5 flex-shrink-0",children:[s.jsx(j,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>y(e.id,-1),disabled:t<=0,children:"-"}),s.jsx("span",{className:"text-sm font-medium w-8 text-center tabular-nums",children:t}),s.jsx(j,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>y(e.id,1),disabled:t>=a,children:"+"})]})]})]})})},e.id)};return s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 sm:p-3 rounded-lg cursor-pointer",onClick:()=>w(e=>!e),children:[s.jsx("h3",{className:"font-medium text-gray-800",children:h.category}),g?s.jsx(M,{className:"w-5 h-5 text-gray-500"}):s.jsx(O,{className:"w-5 h-5 text-gray-500"})]}),g&&s.jsx("div",{className:"mt-2 sm:mt-3 space-y-2 sm:space-y-3",children:h.items.map(E)}),s.jsx("div",{className:"desktop-close-hint text-xs",style:{marginTop:10,color:"#888",textAlign:"center"},children:"ESC или клик вне меню для закрытия"})]})}},xe=[];export{xe as __namedExportsOrder,me as default};
//# sourceMappingURL=TaskCategoryBlock.stories-DmOWlMQM.js.map
