import{j as e}from"./jsx-runtime-DoEZbXM1.js";import{r as d}from"./index-DWtqY3O_.js";import{B as L}from"./button-DWZKWoqU.js";import{I as De}from"./input-CZpXrphG.js";import{S as Y,a as Z,b as ee,c as se,d as m}from"./select-B6o2Elem.js";import{T as Te,a as Ie,b as M,c as P}from"./tabs-C71B0fzz.js";import{P as te}from"./progress-BjH4sRUs.js";import{t as S,e as ae,a as le}from"./test-content-jx8OslLq.js";import{S as Ee}from"./selectable-exam-text-DpZXay-P.js";import{B as g}from"./badge-BhI_kZ9I.js";import{P as re,a as ne,b as ie}from"./popover-C4RQM193.js";import{T as Le}from"./TaskCardBlock-CiEdU8zU.js";import{U as Me}from"./user-CdTAPmPH.js";import{c as de}from"./createLucideIcon-BySMWYsL.js";import{F as Pe}from"./folder-plus-v-DhVONG.js";import{C as B,a as N}from"./chevron-up-BDhz3SY9.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=de("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=de("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),ze={"tasks-1":{easiest:2,easy:5,medium:10,hard:6,hardest:1},"tasks-2":{easiest:3,easy:8,medium:12,hard:5,hardest:2},"tasks-3":{easiest:0,easy:2,medium:8,hard:10,hardest:5},"tasks-26":{easiest:1,easy:4,medium:9,hard:7,hardest:3},"tasks-4":{easiest:5,easy:10,medium:15,hard:3,hardest:1},"tasks-5":{easiest:8,easy:15,medium:10,hard:2,hardest:0},"tasks-6":{easiest:2,easy:6,medium:11,hard:8,hardest:2},"tasks-7":{easiest:1,easy:5,medium:10,hard:9,hardest:4},"tasks-8":{easiest:0,easy:1,medium:7,hard:12,hardest:6},"tasks-9":{easiest:3,easy:7,medium:13,hard:6,hardest:2},"tasks-10":{easiest:4,easy:8,medium:14,hard:5,hardest:1},"tasks-11":{easiest:2,easy:6,medium:12,hard:7,hardest:3},"tasks-12":{easiest:0,easy:2,medium:9,hard:11,hardest:5},"tasks-13":{easiest:3,easy:8,medium:11,hard:6,hardest:2},"tasks-14":{easiest:2,easy:7,medium:13,hard:7,hardest:3},"tasks-15":{easiest:4,easy:9,medium:12,hard:5,hardest:1},"tasks-16":{easiest:3,easy:7,medium:10,hard:8,hardest:3},"tasks-17":{easiest:2,easy:6,medium:11,hard:9,hardest:4},"tasks-18":{easiest:1,easy:3,medium:8,hard:12,hardest:6},"tasks-19":{easiest:3,easy:8,medium:12,hard:7,hardest:2},"tasks-20":{easiest:1,easy:4,medium:9,hard:11,hardest:5},"tasks-21":{easiest:2,easy:7,medium:11,hard:8,hardest:3},"tasks-22":{easiest:4,easy:9,medium:13,hard:5,hardest:1},"tasks-23":{easiest:3,easy:8,medium:12,hard:6,hardest:2},"tasks-24":{easiest:1,easy:3,medium:8,hard:10,hardest:5},"tasks-25":{easiest:2,easy:6,medium:10,hard:9,hardest:4},"ege-1-1":{easiest:5,easy:10,medium:8,hard:3,hardest:1},"ex-1-1-1":{easiest:10,easy:15,medium:5,hard:1,hardest:0}},F=[{id:"easiest",label:"Самые лёгкие"},{id:"easy",label:"Лёгкие"},{id:"medium",label:"Средние"},{id:"hard",label:"Сложные"},{id:"hardest",label:"Самые сложные"}];function ts(){const[z,ce]=d.useState(""),[me,oe]=d.useState(void 0),[xe,he]=d.useState(void 0),[v,G]=d.useState(null),[y,O]=d.useState(null),[b,V]=d.useState(null),[J,ue]=d.useState({}),[p,A]=d.useState({}),[fe,pe]=d.useState("tasks"),[Ge,Oe]=d.useState(""),[ge,w]=d.useState("Создать тест"),k=50,[U,R]=d.useState(0),je=U/k*100,[W,Ne]=d.useState(!1),[H,ve]=d.useState(!1),[_,ye]=d.useState(!1),[be,q]=d.useState(!0),[we,ke]=d.useState(!1),[$,Ce]=d.useState({});d.useEffect(()=>{try{if(!S||!ae||!le)throw new Error("Data is missing");G(S),O(ae),V(le),S.length>0&&A(s=>({...s,[S[0].category]:!0})),q(!1)}catch(s){console.error("Error initializing data:",s),ke(!0),q(!1)}},[]),d.useEffect(()=>{Se()},[W,H,_]);const Se=()=>{const s=[];W&&s.push("по заданиям"),H&&s.push("ЕГЭ"),_&&s.push("упражнения"),s.length===0?w("Создать тест"):s.length===1?w(`Создать тест ${s[0]}`):s.length===2?w(`Создать тест ${s[0]} и ${s[1]}`):w(`Создать тест ${s[0]}, ${s[1]} и ${s[2]}`)},K=(s,l,a,r)=>{let n;if(r==="tasks"){n=JSON.parse(JSON.stringify(v));for(const t of n){const i=t.items.find(c=>c.id===s);if(i){const c=i.count||0,f=Math.max(0,Math.min(i.maxCount||10,c+a));i.count=f,R(x=>Math.max(0,Math.min(k,x+(f-c))));const o=n.some(x=>x.items.some(u=>u.count&&u.count>0));Ne(o),G(n);break}}}else if(r==="ege"||r==="exercises"){n=JSON.parse(JSON.stringify(r==="ege"?y:b));let i=!1;for(const c of n){for(const f of c.categories){const o=f.items.find(x=>x.id===s);if(o){const x=o.count||0,u=Math.max(0,Math.min(o.maxCount||10,x+a));o.count=u,R(h=>Math.max(0,Math.min(k,h+(u-x))));const j=n.some(h=>h.categories.some(E=>E.items.some(X=>X.count&&X.count>0)));r==="ege"?ve(j):ye(j),r==="ege"?O(n):V(n),i=!0;break}}if(i)break}}},D=(s,l)=>{ue(a=>{const r=a[s]||[];if(l==="any")return{...a,[s]:["any"]};let n;return r.includes(l)?(n=r.filter(t=>t!==l),n.length===0&&(n=["any"])):n=r.filter(t=>t!=="any").concat(l),{...a,[s]:n}})},T=s=>{A(l=>({...l,[s]:!l[s]}))},C=(s,l)=>{Ce({...$,[s]:l})},I=(s,l,a)=>{var j;const r=s.count||0,n=s.maxCount||10,t="category"in l?l.category:l.title,i=`${a}-${s.id}`,c=ze[i]||null,o=!!((j=s.title.match(/№\s*(\d+)/))==null?void 0:j[1]),x=o?["Орфография","Пунктуация","Лексика","Морфология"]:[];let u=null;if(o&&c){const h=Q(s,c),E=$e(s,x);u=e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},className:"sb-interactive-block",children:[E,h]})}else if(!o&&c){const h=Q(s,c);u=e.jsx("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},className:"sb-interactive-block",children:h})}return e.jsx(Le,{item:{...s,title:o?s.title:s.title.replace(/№\s*\d+\.\s*/,"")},category:null,currentCount:r,maxCount:n,onDecrement:()=>K(s.id,t,-1,a),onIncrement:()=>K(s.id,t,1,a),difficulties:J[s.id]||["any"],onDifficultyChange:h=>D(s.id,h),categories:$[s.id]||x,onCategoriesChange:h=>C(s.id,h),itemStats:c,difficultyTiers:F,difficultyDropdown:u,categoryDropdown:null},s.id)},Q=(s,l)=>{s.id;const a=J[s.id]||["any"],r=()=>{if(!a||a.includes("any"))return"любая сложность";const t=a.map(i=>{const c=F.find(f=>f.id===i);return c?c.label.toLowerCase():i.toLowerCase()});return t.length===1?t[0]:t.length===2?`${t[0]} и ${t[1]}`:t.length>2?`${t[0]}, ${t[1]} +${t.length-2}`:""},n=Object.values(l||{}).reduce((t,i)=>Number(t)+Number(i),0);return e.jsxs(re,{children:[e.jsx(ne,{asChild:!0,children:e.jsxs(g,{variant:"outline",className:"cursor-pointer py-1 px-3 flex items-center gap-1.5 hover:bg-gray-100 transition-colors dropdown-badge",children:[e.jsx("span",{className:"text-xs",children:r()}),e.jsx(N,{className:"h-3 w-3"})]})}),e.jsx(ie,{className:"w-auto p-2",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(g,{variant:!a||a.includes("any")?"default":"outline",className:"cursor-pointer",onClick:()=>D(s.id,"any"),children:["любая сложность ",e.jsx("span",{className:"ml-1",children:n})]},"any"),F.map(t=>{const i=l[t.id]||0;return e.jsxs(g,{variant:a.includes(t.id)&&!a.includes("any")?"default":"outline",className:"cursor-pointer",onClick:()=>D(s.id,t.id),children:[t.label.toLowerCase()," ",e.jsx("span",{className:"ml-1",children:i})]},t.id)})]})})]})},$e=(s,l)=>{const a=s.id,r=$[s.id]||l,n=()=>{if(r.length===l.length)return"все категории";const t=r.map(i=>i.toLowerCase());return t.length===1?t[0]:t.length===2?`${t[0]} и ${t[1]}`:t.length>2?`${t[0]}, ${t[1]} +${t.length-2}`:""};return e.jsxs(re,{children:[e.jsx(ne,{asChild:!0,children:e.jsxs(g,{variant:"outline",className:"cursor-pointer py-1 px-3 flex items-center gap-1.5 hover:bg-gray-100 transition-colors dropdown-badge",children:[e.jsx("span",{className:"text-xs",children:n()}),e.jsx(N,{className:"h-3 w-3"})]})}),e.jsx(ie,{className:"w-auto p-2",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(g,{variant:r.length===l.length?"default":"outline",className:"cursor-pointer",onClick:()=>C(a,[...l]),children:"Все категории"},"all"),l.map(t=>e.jsx(g,{variant:r.includes(t)&&r.length!==l.length?"default":"outline",className:"cursor-pointer",onClick:()=>{if(r.length===l.length)C(a,[t]);else{let i;r.includes(t)?i=r.filter(c=>c!==t):i=[...r,t],i.length===0&&(i=[...l]),C(a,i)}},children:t},t))]})})]})};return be?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx(te,{value:30,className:"w-[60%] mx-auto"}),e.jsx("p",{className:"mt-4",children:"Загрузка данных..."})]})}):we?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-red-600",children:"Ошибка загрузки"}),e.jsx("p",{className:"mt-2",children:"Не удалось загрузить данные. Пожалуйста, обновите страницу."}),e.jsx(L,{onClick:()=>window.location.reload(),className:"mt-4",children:"Обновить страницу"})]})}):e.jsxs("div",{className:"bg-gray-100 font-sans pb-24 min-h-screen",children:[e.jsxs("nav",{className:"max-w-6xl bg-[#434343] rounded-2xl flex items-center p-2 mx-auto mt-5 mb-10 relative",children:[e.jsxs("span",{className:"text-white text-sm font-medium px-3 py-2",children:["Русский",e.jsx("span",{className:"text-teal-400",children:"_100"})]}),e.jsxs("div",{className:"hidden lg:flex flex-wrap flex-1 items-center",children:[e.jsx("a",{href:"#",className:"text-white text-sm font-medium bg-[#515151] rounded-xl px-4 py-2 mx-1 my-1 text-center hover:bg-[#616161]",children:"Дашборд"}),e.jsx("a",{href:"#",className:"text-white text-sm font-medium bg-[#515151] rounded-xl px-4 py-2 mx-1 my-1 text-center hover:bg-[#616161]",children:"Задания"}),e.jsx("a",{href:"#",className:"text-white text-sm font-medium bg-[#515151] rounded-xl px-4 py-2 mx-1 my-1 text-center hover:bg-[#616161]",children:"Результаты"})]}),e.jsx("div",{className:"relative ml-auto mx-1 my-1",children:e.jsx("div",{className:"text-white text-sm font-medium bg-[#515151] rounded-xl px-3 py-2 text-center hover:bg-[#616161] cursor-pointer",children:e.jsx(Me,{className:"inline-block w-5 h-5"})})})]}),e.jsxs("div",{className:"container max-w-6xl mx-auto p-3 sm:p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("nav",{className:"breadcrumbs text-sm text-gray-600 hidden sm:block",children:[e.jsx("a",{href:"#",className:"hover:underline",children:"Главная"})," ","> ",e.jsx("span",{children:"Генерация теста"})]}),e.jsxs("a",{href:"#",className:"text-teal-600 hover:underline sm:hidden flex items-center",children:[e.jsx(Be,{className:"w-4 h-4 mr-1"})," Назад"]}),e.jsx("a",{href:"#",className:"text-teal-600 hover:underline text-sm sm:text-base",children:"Мои тесты"})]}),e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800 flex items-center",children:[e.jsx(Fe,{className:"mr-2 text-teal-600 w-6 h-6"})," Генерация теста"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2 mb-6",children:'Выберите задания для включения в тест (не более 50), укажите название, аккаунт и группу, затем нажмите "Создать тест".'}),e.jsx("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm mb-4 sm:mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"test-name",className:"block text-sm font-medium text-gray-700 mb-1",children:["Название теста ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(De,{id:"test-name",value:z,onChange:s=>ce(s.target.value),placeholder:"Введите название теста",className:"w-full"})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"test-group",className:"block text-sm font-medium text-gray-700 mb-1",children:"Группа тестов"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Y,{value:me,onValueChange:oe,children:[e.jsx(Z,{className:"w-full",children:e.jsx(ee,{placeholder:"-- Выберите --"})}),e.jsxs(se,{children:[e.jsx(m,{value:"3",children:"Тесты-25"}),e.jsx(m,{value:"4",children:"Пунктуация"}),e.jsx(m,{value:"5",children:"Пунктуация. Контроль."}),e.jsx(m,{value:"6",children:"Чекапы"}),e.jsx(m,{value:"7",children:"Сочинение"}),e.jsx(m,{value:"8",children:"Сочинение. Контроль."}),e.jsx(m,{value:"9",children:"Грамматика"}),e.jsx(m,{value:"10",children:"Грамматика контроль"}),e.jsx(m,{value:"29",children:"Сгенерированные тесты"}),e.jsx(m,{value:"60",children:"ЕГКР (от ФИПИ)"}),e.jsx(m,{value:"127",children:"Орфография"}),e.jsx(m,{value:"128",children:"Орфография. Контроль"}),e.jsx(m,{value:"255",children:"Орфография (тексты с пропущенными буквами)"}),e.jsx(m,{value:"333",children:"Речь"})]})]}),e.jsx(L,{variant:"outline",size:"icon",className:"flex-shrink-0",children:e.jsx(Pe,{className:"h-5 w-5 text-teal-600"})})]})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"account-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Аккаунт"}),e.jsxs(Y,{value:xe,onValueChange:he,children:[e.jsx(Z,{className:"w-full",children:e.jsx(ee,{placeholder:"-- Выберите аккаунт --"})}),e.jsxs(se,{children:[e.jsx(m,{value:"1",children:"Аккаунт 1"}),e.jsx(m,{value:"2",children:"Аккаунт 2"}),e.jsx(m,{value:"3",children:"Аккаунт 3"})]})]})]})})]})}),e.jsx("div",{className:"mb-4",children:e.jsx(Ee,{})}),e.jsxs(Te,{defaultValue:"tasks",value:fe,onValueChange:pe,className:"w-full max-w-full flex flex-col",children:[e.jsx("div",{className:"border-b border-gray-200 sticky top-0 z-30 bg-white shadow-sm overflow-hidden rounded-t-xl",children:e.jsxs(Ie,{className:"grid w-full grid-cols-3 bg-transparent shadow-none border-0 h-auto p-0 m-0",children:[e.jsx(M,{value:"tasks",className:"py-3 px-4 text-gray-500 data-[state=active]:bg-teal-600 data-[state=active]:text-white data-[state=active]:shadow-md rounded-none hover:text-gray-700 transition-colors",children:"По заданиям"}),e.jsx(M,{value:"ege",className:"py-3 px-4 text-gray-500 data-[state=active]:bg-teal-600 data-[state=active]:text-white data-[state=active]:shadow-md rounded-none hover:text-gray-700 transition-colors",children:"Формат ЕГЭ"}),e.jsx(M,{value:"exercises",className:"py-3 px-4 text-gray-500 data-[state=active]:bg-teal-600 data-[state=active]:text-white data-[state=active]:shadow-md rounded-none hover:text-gray-700 transition-colors",children:"Упражнения"})]})}),e.jsxs("div",{className:"pt-6",children:[e.jsx(P,{value:"tasks",className:"w-full max-w-full mt-0",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm overflow-hidden",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Генерация по заданиям"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Выберите количество вопросов и уровень сложности для каждого задания:"}),v==null?void 0:v.map(s=>{var l;return s?e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 sm:p-3 rounded-lg cursor-pointer",onClick:()=>T(s.category),children:[e.jsx("h3",{className:"font-medium text-gray-800",children:s.category}),p[s.category]?e.jsx(B,{className:"w-5 h-5 text-gray-500"}):e.jsx(N,{className:"w-5 h-5 text-gray-500"})]}),p[s.category]&&e.jsx("div",{className:"mt-2 sm:mt-3 space-y-2 sm:space-y-3",children:(l=s.items)==null?void 0:l.map(a=>a?I(a,s,"tasks"):null)})]},s.category):null})]})}),e.jsx(P,{value:"ege",className:"w-full max-w-full mt-0",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm overflow-hidden",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Формат ЕГЭ"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Выберите параметры для генерации теста в формате ЕГЭ:"}),y==null?void 0:y.map(s=>{var l;return s?e.jsxs("div",{className:"mb-5 sm:mb-8",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:s.title}),(l=s.categories)==null?void 0:l.map(a=>{var r;return a?e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 sm:p-3 rounded-lg cursor-pointer",onClick:()=>T(`${s.title}-${a.title}`),children:[e.jsx("h4",{className:"font-medium text-gray-800",children:a.title}),p[`${s.title}-${a.title}`]?e.jsx(B,{className:"w-5 h-5 text-gray-500"}):e.jsx(N,{className:"w-5 h-5 text-gray-500"})]}),p[`${s.title}-${a.title}`]&&e.jsx("div",{className:"mt-2 sm:mt-3 space-y-2 sm:space-y-3",children:(r=a.items)==null?void 0:r.map(n=>n?I(n,a,"ege"):null)})]},`${s.title}-${a.title}`):null})]},s.title):null})]})}),e.jsx(P,{value:"exercises",className:"w-full max-w-full mt-0",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm overflow-hidden",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Упражнения"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Выберите упражнения для включения в тест:"}),b==null?void 0:b.map(s=>{var l;return s?e.jsxs("div",{className:"mb-5 sm:mb-8",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:s.title}),(l=s.categories)==null?void 0:l.map(a=>{var r;return a?e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 sm:p-3 rounded-lg cursor-pointer",onClick:()=>T(`${s.title}-${a.title}`),children:[e.jsx("h4",{className:"font-medium text-gray-800",children:a.title}),p[`${s.title}-${a.title}`]?e.jsx(B,{className:"w-5 h-5 text-gray-500"}):e.jsx(N,{className:"w-5 h-5 text-gray-500"})]}),p[`${s.title}-${a.title}`]&&e.jsx("div",{className:"mt-2 sm:mt-3 space-y-2 sm:space-y-3",children:(r=a.items)==null?void 0:r.map(n=>n?I(n,a,"exercises"):null)})]},`${s.title}-${a.title}`):null})]},s.title):null})]})})]})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white shadow-lg border-t border-gray-200 py-3 px-4 z-50",children:e.jsx("div",{className:"container max-w-6xl mx-auto",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Выбрано заданий:"}),e.jsxs("span",{className:"text-lg font-bold text-teal-600",children:[U," / ",k]})]}),e.jsx("div",{className:"w-full sm:w-1/3 flex-grow",children:e.jsx(te,{value:je,className:"h-2"})}),e.jsx(L,{className:"w-full sm:w-auto bg-teal-600 hover:bg-teal-700 text-white px-8 font-medium",variant:"default",disabled:!z,style:{opacity:1},children:ge})]})})})]})}export{ts as T};
//# sourceMappingURL=page-CdMqY4gx.js.map
