# TD-COMP-002: Инвентаризация компонентной библиотеки

**Тип контракта:** Исполнительный  
**Статус:** Черновик  
**Автор:** DesignAI  
**Дата создания:** 2023-06-04  
**Родительский контракт:** TD-COMP-001  
**Связанные контракты:** TD-MS-001, TD-PREP-001  

## 1. Цель контракта

Провести комплексную инвентаризацию всех компонентов пользовательского интерфейса в проекте, включая используемые и неиспользуемые компоненты, их зависимости, состояние и качество, для создания полной базы знаний для последующей стандартизации компонентной библиотеки.

## 2. Описание проблемы

В ходе предварительного анализа выявлены следующие проблемы:

- Отсутствие единого реестра компонентов
- Расхождения в стилях между различными страницами (например, `app/page.tsx` и `app/account/page.tsx`)
- Наличие неиспользуемых и дублирующих компонентов
- Неполная документация в Storybook
- Разрозненные подходы к структуре и API компонентов

Эти проблемы делают невозможным эффективное внедрение системы токенов и затрудняют разработку и поддержку интерфейса. Для их решения необходима полная инвентаризация компонентов.

## 3. Объем работ

### 3.1. Области анализа

1. **Используемые компоненты**:
   - Компоненты UI (кнопки, поля ввода, карточки и т.д.)
   - Композитные компоненты (формы, модальные окна и т.д.)
   - Специализированные бизнес-компоненты (ProfileCard, TariffPaymentCard и т.д.)

2. **Неиспользуемые или экспериментальные компоненты**:
   - Компоненты в истории Storybook
   - Компоненты, находящиеся в кодовой базе, но не используемые на страницах
   - Устаревшие версии компонентов

3. **Сторонние библиотеки и зависимости**:
   - Используемые библиотеки UI компонентов
   - Собственные утилиты и хелперы для UI
   - Библиотеки стилей и анимаций

### 3.2. Задачи

1. **Анализ файловой структуры**:
   - Исследование структуры директорий компонентов
   - Выявление паттернов организации кода

2. **Аудит компонентов**:
   - Сбор полного списка всех компонентов
   - Анализ использования компонентов на страницах
   - Изучение структуры пропсов и API компонентов

3. **Выявление визуальных стилей и паттернов**:
   - Анализ используемых стилей (CSS, Tailwind, inline styles)
   - Определение визуальных паттернов и несоответствий
   - Сопоставление со спецификацией токенов

4. **Создание реестра компонентов**:
   - Категоризация и классификация компонентов
   - Определение состояния и качества компонентов
   - Приоритизация для будущей стандартизации

5. **Анализ Storybook**:
   - Оценка полноты документации
   - Выявление несоответствий между документацией и реализацией
   - Определение отсутствующих компонентов в документации

## 4. Методология

### 4.1. Инструменты анализа

1. **Статический анализ кода**:
   - Использование инструментов для определения зависимостей
   - Анализ импортов/экспортов для построения графа компонентов
   - Поиск неиспользуемого кода

2. **Визуальный аудит**:
   - Скриншоты компонентов в различных состояниях
   - Сравнение визуальных стилей между компонентами
   - Выявление несоответствий дизайну

3. **Анализ документации**:
   - Изучение существующей документации в Storybook
   - Анализ комментариев в коде
   - Сбор информации из README и других документов

### 4.2. Процесс работы

1. **Сбор данных**:
   - Автоматический сбор метаданных о компонентах
   - Ручной обзор ключевых страниц и компонентов
   - Интервью с разработчиками (если возможно)

2. **Анализ и категоризация**:
   - Группировка компонентов по типам и функциональности
   - Оценка сложности и качества компонентов
   - Выявление дублирующейся функциональности

3. **Документирование**:
   - Создание структурированного реестра компонентов
   - Определение приоритетов для стандартизации
   - Фиксация выявленных проблем и рекомендаций

## 5. Ожидаемые результаты

### 5.1. Документы

1. **Реестр компонентов** в формате таблицы с следующими полями:
   - Название и путь к компоненту
   - Категория (базовый, композитный, специализированный)
   - Используется ли компонент на боевых страницах
   - Степень документированности
   - Состояние (актуальный, требует обновления, устаревший)
   - Приоритет для стандартизации
   - Зависимости от других компонентов
   - Потенциальные проблемы интеграции с токенами

2. **Отчет о визуальном аудите** с:
   - Скриншотами ключевых компонентов
   - Выявленными несоответствиями и проблемами
   - Рекомендациями по стандартизации

3. **Анализ паттернов API** компонентов:
   - Стандартные пропсы и их использование
   - Несоответствия в названиях и типах пропсов
   - Рекомендации по стандартизации API

4. **План стандартизации** с:
   - Списком компонентов для стандартизации
   - Приоритетами и этапами стандартизации
   - Рекомендуемые подходы к миграции

### 5.2. Примеры компонентов

Для каждой категории компонентов будут выбраны репрезентативные примеры, которые будут подробно проанализированы с точки зрения:
- Структуры кода
- API и пропсов
- Стилизации и использования классов
- Возможности интеграции с токенами

## 6. Критерии приемки

1. **Полнота реестра**:
   - Учтены все компоненты в директориях UI и feature
   - Зафиксированы все стили и паттерны дизайна
   - Документированы все отклонения от стандартов

2. **Качество анализа**:
   - Четкая категоризация компонентов
   - Выявлены все основные паттерны использования
   - Определены проблемные области и компоненты

3. **Практическая ценность**:
   - Реестр содержит всю информацию, необходимую для дальнейшей стандартизации
   - Рекомендации по стандартизации конкретны и применимы
   - План стандартизации реалистичен и выполним

## 7. Зависимости и риски

### 7.1. Зависимости

1. **Доступ к кодовой базе**:
   - Полный доступ ко всем файлам проекта
   - Доступ к истории Storybook

2. **Информация о системе токенов**:
   - Доступ к спецификации системы токенов (TD-MS-001)
   - Результаты аудита CSS-переменных (TD-PREP-001)

### 7.2. Риски

| Риск | Воздействие | Вероятность | Стратегия смягчения |
|------|-------------|-------------|---------------------|
| Неполный доступ к кодовой базе | Высокое | Низкая | Запросить дополнительные разрешения, использовать доступные исходники |
| Сложность определения использования компонентов | Среднее | Средняя | Использовать инструменты статического анализа, консультации с разработчиками |
| Большое количество недокументированных компонентов | Высокое | Высокая | Фокус на ключевых компонентах, применение обратного инжиниринга |
| Ограниченное время для анализа | Среднее | Средняя | Приоритизация компонентов, использование автоматизированных инструментов |

## 8. Подход к реализации

### 8.1. Этапы работы

1. **Подготовка** (1-2 дня):
   - Настройка инструментов анализа
   - Создание шаблонов для документирования
   - Определение методологии категоризации

2. **Первичный анализ** (3-5 дней):
   - Сканирование файловой структуры
   - Автоматический сбор метаданных
   - Построение графа зависимостей компонентов

3. **Детальный анализ** (7-10 дней):
   - Ручной аудит ключевых компонентов
   - Визуальный аудит и скриншоты
   - Анализ API и пропсов

4. **Документирование** (3-5 дней):
   - Создание реестра компонентов
   - Написание отчетов и рекомендаций
   - Разработка плана стандартизации

### 8.2. Результаты этапов

- **После первичного анализа**: Предварительный список всех компонентов с базовой категоризацией
- **После детального анализа**: Полные метаданные для каждого компонента, выявленные проблемы и паттерны
- **После документирования**: Полный комплект документов и рекомендаций

## 9. Критерии завершения

Контракт считается выполненным при наличии следующих результатов:

1. Полный реестр компонентов с категоризацией и метаданными
2. Отчет о визуальном аудите с скриншотами и выявленными проблемами
3. Анализ API-паттернов с рекомендациями по стандартизации
4. План стандартизации с приоритетами и этапами

## 10. Дальнейшие шаги

После завершения инвентаризации компонентов следующими шагами будут:

1. Разработка архитектуры компонентной библиотеки (TD-COMP-003)
2. Определение стандартов API и структуры компонентов
3. Создание прототипов ключевых компонентов
4. Интеграция с системой токенов 