{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://contract-driven.dev/schemas/contract.schema.json",
  "title": "Component Contract",
  "description": "Schema for component contracts in Contract-Driven Development methodology",
  "type": "object",
  "required": ["id", "title", "type", "props", "acceptance_criteria"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^CONTRACT-[A-Z0-9]+-\\d{3}$",
      "description": "Unique contract identifier (e.g., CONTRACT-BUTTON-001)"
    },
    "title": {
      "type": "string",
      "minLength": 3,
      "description": "Human-readable contract title"
    },
    "type": {
      "type": "string",
      "enum": ["component", "section", "page", "utility", "service"],
      "description": "Type of entity this contract describes"
    },
    "description": {
      "type": "string",
      "description": "Detailed description of purpose and behavior"
    },
    "cynefin_domain": {
      "type": "string",
      "enum": ["simple", "complicated", "complex", "chaotic"],
      "description": "Cynefin domain classification for precision guidance"
    },
    "props": {
      "type": "object",
      "description": "Component props/API surface",
      "required": ["required", "optional"],
      "properties": {
        "required": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/prop"
          }
        },
        "optional": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/prop"
          }
        }
      }
    },
    "variants": {
      "type": "array",
      "description": "Visual or behavioral variants",
      "items": {
        "type": "object",
        "required": ["name", "description"],
        "properties": {
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "props": {
            "type": "object",
            "description": "Specific prop values for this variant"
          }
        }
      }
    },
    "states": {
      "type": "array",
      "description": "Interactive states (hover, focus, disabled, loading, etc.)",
      "items": {
        "type": "string"
      }
    },
    "invariants": {
      "type": "array",
      "description": "Conditions that must ALWAYS be true",
      "items": {
        "type": "string"
      }
    },
    "constraints": {
      "type": "object",
      "description": "Boundaries and limitations",
      "properties": {
        "performance": {
          "type": "array",
          "items": {"type": "string"}
        },
        "accessibility": {
          "type": "array",
          "items": {"type": "string"}
        },
        "browser_support": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    },
    "dependencies": {
      "type": "object",
      "properties": {
        "tokens": {
          "type": "array",
          "description": "Design tokens this contract depends on",
          "items": {"type": "string"}
        },
        "components": {
          "type": "array",
          "description": "Other components used",
          "items": {"type": "string"}
        },
        "external": {
          "type": "array",
          "description": "External libraries or APIs",
          "items": {"type": "string"}
        }
      }
    },
    "scope": {
      "type": "object",
      "description": "Blast radius definition",
      "required": ["mutable", "invariant"],
      "properties": {
        "mutable": {
          "type": "array",
          "description": "Files/paths that can be changed",
          "items": {"type": "string"}
        },
        "invariant": {
          "type": "array",
          "description": "Files/paths that must NOT be changed",
          "items": {"type": "string"}
        }
      }
    },
    "anti_patterns": {
      "type": "array",
      "description": "What NOT to do (explicit mistakes to avoid)",
      "items": {
        "type": "object",
        "required": ["pattern", "reason"],
        "properties": {
          "pattern": {"type": "string"},
          "reason": {"type": "string"},
          "alternative": {"type": "string"}
        }
      }
    },
    "acceptance_criteria": {
      "type": "array",
      "description": "Testable criteria for contract compliance",
      "items": {
        "type": "object",
        "required": ["criterion", "validation"],
        "properties": {
          "criterion": {"type": "string"},
          "validation": {
            "type": "string",
            "enum": ["visual", "unit-test", "integration-test", "manual", "automated"]
          }
        }
      }
    },
    "examples": {
      "type": "array",
      "description": "Usage examples",
      "items": {
        "type": "object",
        "properties": {
          "title": {"type": "string"},
          "code": {"type": "string"},
          "description": {"type": "string"}
        }
      }
    },
    "meta": {
      "type": "object",
      "properties": {
        "version": {"type": "string"},
        "created": {"type": "string", "format": "date"},
        "updated": {"type": "string", "format": "date"},
        "author": {"type": "string"},
        "status": {
          "type": "string",
          "enum": ["draft", "review", "approved", "deprecated"]
        }
      }
    }
  },
  "definitions": {
    "prop": {
      "type": "object",
      "required": ["name", "type"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Prop name"
        },
        "type": {
          "type": "string",
          "description": "TypeScript type"
        },
        "default": {
          "description": "Default value"
        },
        "description": {
          "type": "string"
        },
        "validation": {
          "type": "string",
          "description": "Validation rules or constraints"
        }
      }
    }
  }
}
