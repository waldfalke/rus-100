# Contracts

## Обзор системы контрактов

Проект CATMEPIM использует гибридную стратегию управления контрактами (#DECISION_ID_HYBRID_CONTRACTS), которая обеспечивает:
- Централизованный репозиторий контрактов (Single Source of Truth)
- Локальные ссылки/копии в модулях для контекстной доступности
- Автоматическую синхронизацию и валидацию для поддержания консистентности

## Ключевые документы

### Основные документы
- [@java_tools\revised_detailed_contract_programming_analysis_report.md](../java_tools/revised_detailed_contract_programming_analysis_report.md) - Детальный анализ контрактного программирования
- [@Docs\contract_management_workflows.md](../Docs/contract_management_workflows.md) - Рабочие процессы управления контрактами

### Дополнительные материалы
- [@java_tools\(лог-с-DeepSeek)-Контрактное-программирование-ИИ.md](../java_tools/(лог-с-DeepSeek)-Контрактное-программирование-ИИ.md) - Лог обсуждения с DeepSeek
- [@java_tools\(лог-Grok)-контрактное-программирование.md](../java_tools/(лог-Grok)-контрактное-программирование.md) - Лог обсуждения с Grok

### Документы по дедупликации и нормализации
- [@java_tools\SOTA_(Главный)_Дедупликация_товарных_данных.md](../java_tools/SOTA_(Главный)_Дедупликация_товарных_данных.md) - Главный документ по дедупликации
- [@java_tools\SOTA_(пункт1)_Нормализация.md](../java_tools/SOTA_(пункт1)_Нормализация.md) - Нормализация данных
- [@java_tools\SOTA_(Пункт2)_Сортировка_и_блокировка.md](../java_tools/SOTA_(Пункт2)_Сортировка_и_блокировка.md) - Сортировка и блокировка

## Текущие активные контракты

| Контракт | Версия | Статус | Ответственный | Ветка | Тесты |
|----------|--------|--------|---------------|-------|--------|
| Converter | 1.1.0 | Стабильный | AI | main | Да |
| Deduplicator | 1.0.0 | Стабильный | AI | main | Да |
| DatabaseLoader | 1.0.0 | Стабильный | AI | main | Да |
| DataAnalyzer | 1.0.0 | Стабильный | AI | main | Да |

### Недавно обновленные контракты

#### Converter
Обновлен контракт для модуля Converter:
- [Архитектурный контракт](../contracts/Converter-Architecture-Contract.md) - высокоуровневое описание модуля
- [Интерфейсный контракт](../contracts/interfaces/converter/contract.md) - контракт интерфейса Converter
- [Контракт VendorDetector](../contracts/interfaces/converter/vendor-detector.md) - контракт для определения поставщика
- [JSON-схема выходных данных](../contracts/data/json-schema/converter-output-schema.json) - схема для валидации выходных данных

#### DatabaseLoader
Создан полный набор контрактов для модуля DatabaseLoader:
- [Архитектурный контракт](../contracts/DatabaseLoader-Architecture-Contract.md) - высокоуровневое описание модуля
- [Интерфейсный контракт](../contracts/interfaces/database-loader/contract.md) - контракт интерфейса DatabaseLoader
- [Контракт конфигурации](../contracts/interfaces/database-loader/database-config.md) - контракт для конфигурации подключения к базе данных

#### DataAnalyzer
Создан полный набор контрактов для модуля DataAnalyzer:
- [Архитектурный контракт](../contracts/DataAnalyzer-Architecture-Contract.md) - высокоуровневое описание модуля
- [Интерфейсный контракт](../contracts/interfaces/data-analyzer/contract.md) - контракт интерфейса DataAnalyzer
- [Контракт конфигурации](../contracts/interfaces/data-analyzer/analyzer-config.md) - контракт для конфигурации анализа данных

#### Deduplicator
Создан полный набор контрактов для модуля Deduplicator:
- [Архитектурный контракт](../contracts/Deduplicator-Architecture-Contract.md) - высокоуровневое описание модуля
- [Интерфейсный контракт](../contracts/interfaces/deduplicator/contract.md) - контракт интерфейса Deduplicator
- [Контракт конфигурации](../contracts/interfaces/deduplicator/deduplication-config.md) - контракт для конфигурации алгоритмов
- [Контракт алгоритмов](../contracts/interfaces/deduplicator/algorithms.md) - контракты для алгоритмов дедупликации
- [JSON-схема входных данных](../contracts/data/json-schema/deduplicator-input-schema.json) - схема для валидации входных данных
- [JSON-схема выходных данных](../contracts/data/json-schema/deduplicator-output-schema.json) - схема для валидации выходных данных

## Протокол работы с контрактами

1. **Перед началом работы**:
   - Проверить этот файл для понимания текущего состояния контрактов
   - Проверить OWNERSHIP.md для определения доступных задач
   - Запустить тесты контрактов для проверки их согласованности

2. **Начало работы с контрактом**:
   - Создать ветку для работы (если требуется)
   - Обновить OWNERSHIP.md, указав себя ответственным
   - Обновить этот файл, изменив статус контракта

3. **Работа с контрактом**:
   - Следовать стандартам документирования контрактов
   - Обеспечивать синхронизацию контракта и кода
   - Документировать все изменения в истории контракта
   - Разрабатывать тесты для проверки контракта

4. **Завершение работы**:
   - Создать резюме изменений (HANDOVER.md)
   - Обновить OWNERSHIP.md и этот файл
   - Запустить тесты контрактов для проверки изменений
   - Создать PR или оставить заметки для следующего ИИ

## Кросс-ссылки (Cross-References)

- См. решение #DECISION_ID_HYBRID_CONTRACTS в [decisionLog.md](./decisionLog.md)
- См. текущие задачи в [progress.md](./progress.md)
- См. общий контекст проекта в [productContext.md](./productContext.md)
- См. PRD для Java-компонентов в [@java_tools\java-pim-PRD.md](../java_tools/java-pim-PRD.md)
- См. технические тесты контрактов в [../contracts/tests/README.md](../contracts/tests/README.md)
- См. онтологическое тестирование контрактов в [../contracts/tests/ontological/README.md](../contracts/tests/ontological/README.md)

## Синтез и инсайты

- [ ] Контракты должны быть доступны всем ИИ-ассистентам для обеспечения согласованности работы
- [ ] Гибридная стратегия управления контрактами критически важна для сред с несколькими ИИ
- [ ] Поэтапный переход от "контрактов-из-кода" к "коду-из-контракта" обеспечивает плавную эволюцию системы
- [ ] Тестирование контрактов так же важно, как и тестирование реализаций
- [ ] Контракты должны проверяться на внутреннюю согласованность, совместимость и реализуемость
- [ ] Онтологическое тестирование контрактов позволяет выявить скрытые противоречия и неполноту на концептуальном уровне
- [ ] Трехступенчатый подход к онтологическому анализу позволяет масштабировать глубину анализа в зависимости от критичности контракта
