# UX Контракт: Компонент прогресс-индикатора

## Метаданные
- **Версия**: 1.0.0
- **Статус**: В разработке
- **Последнее обновление**: 2023-05-23
- **Последний редактор**: AI

## Назначение
Компонент прогресс-индикатора предоставляет визуальную обратную связь о текущем состоянии заполнения теста и служит индикатором приближения к ограничению максимального количества вопросов. Он помогает пользователю отслеживать, сколько заданий уже добавлено в тест и сколько еще можно добавить.

## Визуальное представление
Компонент представлен в виде горизонтальной полосы прогресса с текстовым индикатором текущего состояния. Полоса заполняется слева направо по мере добавления вопросов, меняя цвет при приближении к максимальному значению.

Основные визуальные элементы используют следующие Tailwind классы:
- Контейнер прогресс-бара: `mt-6 max-w-xl w-full`
- Полоса прогресса (фон): `bg-gray-200 rounded-full h-2.5`
- Полоса прогресса (заполнение): `h-2.5 rounded-full`
- Текстовый индикатор: `text-sm text-gray-500 mt-2`

## Состояния
- **Низкое заполнение (0-50%)**: `bg-green-500` - зеленый цвет индикатора
- **Среднее заполнение (50-80%)**: `bg-yellow-500` - желтый цвет индикатора
- **Высокое заполнение (80-100%)**: `bg-red-500` - красный цвет индикатора
- **Превышение лимита (>100%)**: `bg-red-600` - ярко-красный цвет с эффектом пульсации
- **Пустой (0%)**: Минимальная заполненность полосы
- **Полный (100%)**: Полная заполненность полосы
- **Загрузка**: Анимация загрузки при расчете прогресса (при необходимости)

## Поведение
- Прогресс-бар увеличивается в режиме реального времени при добавлении вопросов
- Прогресс-бар уменьшается при удалении вопросов
- Цвет меняется в зависимости от текущего процента заполнения
- Текстовый индикатор отображает текущее количество вопросов и максимально допустимое (например, "15/50 вопросов")
- При приближении к лимиту (>90%) может отображаться предупреждающее сообщение
- При превышении лимита отображается уведомление об ошибке

## Доступность
- Компонент имеет атрибут `role="progressbar"`
- Используются атрибуты `aria-valuenow`, `aria-valuemin` и `aria-valuemax` для передачи текущего значения
- Текстовый индикатор связан с полосой прогресса через `aria-describedby`
- Цветовая индикация дополнена текстовыми метками для пользователей с нарушениями цветовосприятия
- При значительных изменениях прогресса обновляется атрибут `aria-live` для оповещения скринридеров

## Адаптивность
- На мобильных устройствах прогресс-бар сохраняет полную ширину контейнера
- Текстовый индикатор адаптируется к размеру экрана
- На маленьких экранах упрощается отображение дополнительной информации
- Полоса прогресса имеет минимальную высоту для удобства взаимодействия на тачскринах

## Примеры использования
```jsx
// Пример разметки компонента прогресс-индикатора
const ProgressIndicator = ({ current, maximum }) => {
  const percentage = Math.min(100, (current / maximum) * 100);
  
  // Определение цвета в зависимости от заполнения
  const getProgressColor = () => {
    if (percentage <= 50) return 'bg-green-500';
    if (percentage <= 80) return 'bg-yellow-500';
    return 'bg-red-500';
  };
  
  return (
    <div className="mt-6 max-w-xl w-full">
      <div className="flex justify-between mb-1">
        <span className="text-sm font-medium text-gray-700">Выбрано вопросов</span>
        <span className="text-sm font-medium text-gray-700">{current}/{maximum}</span>
      </div>
      <div className="w-full bg-gray-200 rounded-full h-2.5">
        <div
          className={`${getProgressColor()} h-2.5 rounded-full`}
          style={{ width: `${percentage}%` }}
          role="progressbar"
          aria-valuenow={current}
          aria-valuemin="0"
          aria-valuemax={maximum}
        ></div>
      </div>
      <div 
        id="progress-description" 
        className="text-sm text-gray-500 mt-2"
        aria-live="polite"
      >
        {percentage >= 90 
          ? 'Приближается лимит вопросов!' 
          : `Вы выбрали ${current} из ${maximum} возможных вопросов.`
        }
      </div>
    </div>
  );
};
```

## Предусловия и постусловия
- **Предусловия**: 
  - Должны быть определены текущее и максимальное значения
  - Максимальное значение должно быть положительным числом
  - Текущее значение должно быть неотрицательным числом

- **Постусловия**:
  - Прогресс-бар отображает корректное процентное соотношение
  - Текстовое описание соответствует текущему состоянию
  - Цветовая индикация соответствует установленным порогам

## Инварианты
- Прогресс всегда находится в диапазоне от 0% до 100% визуально (даже если фактическое значение превышает максимум)
- Текущее значение не может быть отрицательным
- Если текущее значение превышает максимум, отображается соответствующее предупреждение
- Порядок цветовой индикации всегда соответствует установленным порогам

## Интеграция с другими компонентами
- **TestGenerator** - получает данные о текущем количестве выбранных вопросов
- **TaskSelection** - отправляет данные об изменении количества вопросов
- **TabPanel** - интегрирует прогресс-индикатор в интерфейс вкладок

## Связанные контракты
- [TestGenerator Product Contract](./TestGenerator-Product-Contract.md)
- [UX контракт: Выбор заданий](./TestGenerator-UX-TaskSelection-Contract.md)
- [UX контракт: Панель вкладок](./TestGenerator-UX-TabPanel-Contract.md) 